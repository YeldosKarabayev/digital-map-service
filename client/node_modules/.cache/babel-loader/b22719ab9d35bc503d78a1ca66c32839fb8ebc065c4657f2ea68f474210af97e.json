{"ast":null,"code":"import{useState,useEffect}from\"react\";import{useAddNewUserMutation}from\"./usersApiSlice\";import{ROLES}from\"../../config/roles\";import{useNavigate}from\"react-router\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const USER_REGEX=/^[A-z]{3,20}$/;const PWD_REGEX=/^[A-z0-9!@#$%]{4,12}$/;const NewUserForm=()=>{const[addNewUser,{isLoading,isSuccess,isError,error}]=useAddNewUserMutation();const navigate=useNavigate();const[username,setUsername]=useState('');const[validUsername,setValidUsername]=useState(false);const[password,setPassword]=useState('');const[validPassword,setValidPassword]=useState(false);const[roles,setRoles]=useState('Employee');useEffect(()=>{setValidUsername(USER_REGEX.test(username));},[username]);useEffect(()=>{setValidPassword(PWD_REGEX.test(password));},[password]);useEffect(()=>{if(isSuccess){setUsername('');setPassword('');setRoles([]);navigate('/dash/users');alert(\"Новый пользователь добавлен!\");}},[isSuccess,navigate]);const onUsernameChanged=e=>setUsername(e.target.value);const onPasswordChanged=e=>setPassword(e.target.value);const onRolesChanged=e=>{const values=Array.from(e.target.selectedOptions,//HTMLCollection \noption=>option.value);setRoles(values);};const canSave=[roles.length,validUsername,validPassword].every(Boolean)&&!isLoading;const onSaveUserClicked=async e=>{e.preventDefault();if(canSave){await addNewUser({username,password,roles});}};const options=Object.values(ROLES).map(role=>{return/*#__PURE__*/_jsxs(\"option\",{value:role,children:[\" \",role]},role);});const errClass=isError?\"errmsg\":\"offscreen\";const validUserClass=!validUsername?'form__input--incomplete':'';const validPwdClass=!validPassword?'form__input--incomplete':'';const validRolesClass=!Boolean(roles.length)?'form__input--incomplete':'';return/*#__PURE__*/_jsx(\"div\",{className:\"full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"signupScreen\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"form\",onSubmit:onSaveUserClicked,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form__title-row\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{className:\"save_button\",title:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\",disabled:!canSave,children:\"C\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]}),/*#__PURE__*/_jsx(\"label\",{className:\"title\",htmlFor:\"username\",children:\"\\u0418\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F: \"}),/*#__PURE__*/_jsx(\"input\",{className:\"inputsave \".concat(validUserClass),id:\"username\",name:\"username\",type:\"text\",autoComplete:\"off\",value:username,onChange:onUsernameChanged}),/*#__PURE__*/_jsx(\"label\",{className:\"title\",htmlFor:\"password\",children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C: \"}),/*#__PURE__*/_jsx(\"input\",{className:\"inputsave \".concat(validPwdClass),id:\"password\",name:\"password\",type:\"password\",value:password,onChange:onPasswordChanged}),/*#__PURE__*/_jsx(\"label\",{className:\"title\",htmlFor:\"roles\",children:\"\\u041D\\u0410\\u0417\\u041D\\u0410\\u0427\\u0415\\u041D\\u041D\\u042B\\u0415 \\u0420\\u041E\\u041B\\u0418:\"}),/*#__PURE__*/_jsx(\"select\",{id:\"roles\",name:\"roles\",className:\"inputsave \".concat(validRolesClass),multiple:true,size:\"3\",value:roles,onChange:onRolesChanged,children:options})]})})});};export default NewUserForm;","map":{"version":3,"names":["useState","useEffect","useAddNewUserMutation","ROLES","useNavigate","jsxs","_jsxs","jsx","_jsx","USER_REGEX","PWD_REGEX","NewUserForm","addNewUser","isLoading","isSuccess","isError","error","navigate","username","setUsername","validUsername","setValidUsername","password","setPassword","validPassword","setValidPassword","roles","setRoles","test","alert","onUsernameChanged","e","target","value","onPasswordChanged","onRolesChanged","values","Array","from","selectedOptions","option","canSave","length","every","Boolean","onSaveUserClicked","preventDefault","options","Object","map","role","children","errClass","validUserClass","validPwdClass","validRolesClass","className","onSubmit","title","disabled","htmlFor","concat","id","name","type","autoComplete","onChange","multiple","size"],"sources":["C:/Users/MSI/Desktop/final-map-app/client/client/src/features/users/NewUserForm.js"],"sourcesContent":["import { useState, useEffect } from \"react\"\r\nimport { useAddNewUserMutation } from \"./usersApiSlice\"\r\nimport { ROLES } from \"../../config/roles\"\r\nimport { useNavigate } from \"react-router\"\r\n\r\nconst USER_REGEX = /^[A-z]{3,20}$/\r\nconst PWD_REGEX = /^[A-z0-9!@#$%]{4,12}$/\r\n\r\nconst NewUserForm = () => {\r\n\r\n    const  [addNewUser, {\r\n        isLoading, \r\n        isSuccess,\r\n        isError,\r\n        error\r\n    }] = useAddNewUserMutation()\r\n\r\n    const navigate = useNavigate()\r\n\r\n    const [username, setUsername] = useState('')\r\n    const [validUsername, setValidUsername] = useState(false)\r\n    const [password, setPassword] = useState('')\r\n    const [validPassword, setValidPassword] = useState(false)\r\n    const [roles, setRoles] = useState('Employee')\r\n\r\n    useEffect(() => {\r\n        setValidUsername(USER_REGEX.test(username))\r\n    }, [username])\r\n\r\n    useEffect(() => {\r\n        setValidPassword(PWD_REGEX.test(password))\r\n    }, [password])\r\n\r\n    useEffect(() => {\r\n        if (isSuccess) {\r\n            setUsername('')\r\n            setPassword('')\r\n            setRoles([])\r\n            navigate('/dash/users')\r\n            alert(\"Новый пользователь добавлен!\")\r\n        }\r\n    }, [isSuccess, navigate])\r\n\r\n    const onUsernameChanged = e => setUsername(e.target.value)\r\n    const onPasswordChanged = e => setPassword(e.target.value)\r\n\r\n    const onRolesChanged = e => {\r\n        const values = Array.from(\r\n            e.target.selectedOptions, //HTMLCollection \r\n            (option) => option.value\r\n        )\r\n        setRoles(values)\r\n    }\r\n\r\n    const canSave = [roles.length, validUsername, validPassword].every(Boolean) && !isLoading\r\n\r\n    const onSaveUserClicked = async (e) => {\r\n        e.preventDefault()\r\n        if (canSave) {\r\n            await addNewUser({ username, password, roles })\r\n        }\r\n    }\r\n\r\n    const options = Object.values(ROLES).map(role => {\r\n        return (\r\n            <option\r\n                key={role}\r\n                value={role}\r\n\r\n            > {role}</option >\r\n        )\r\n    })\r\n\r\n    const errClass = isError ? \"errmsg\" : \"offscreen\"\r\n    const validUserClass = !validUsername ? 'form__input--incomplete' : ''\r\n    const validPwdClass = !validPassword ? 'form__input--incomplete' : ''\r\n    const validRolesClass = !Boolean(roles.length) ? 'form__input--incomplete' : ''\r\n\r\n\r\n\r\n  return (\r\n    <div className='full'>\r\n        <div className='signupScreen'>\r\n            <form className=\"form\" onSubmit={onSaveUserClicked}>\r\n                <div className=\"form__title-row\">\r\n                    <h2>Новый пользователь</h2>\r\n                    \r\n                        <button\r\n                            className=\"save_button\"\r\n                            title=\"Сохранить\"\r\n                            disabled={!canSave}\r\n                        >\r\n                           Cохранить \r\n                        </button>\r\n                    \r\n                </div>\r\n                <label className='title' htmlFor=\"username\">\r\n                    Имя пользователя: </label>\r\n                <input\r\n                    className={`inputsave ${validUserClass}`}\r\n                    id=\"username\"\r\n                    name=\"username\"\r\n                    type=\"text\"\r\n                    autoComplete=\"off\"\r\n                    value={username}\r\n                    onChange={onUsernameChanged}\r\n                />\r\n\r\n                <label className='title' htmlFor=\"password\">\r\n                    Пароль: </label>\r\n                <input\r\n                    className={`inputsave ${validPwdClass}`}\r\n                    id=\"password\"\r\n                    name=\"password\"\r\n                    type=\"password\"\r\n                    value={password}\r\n                    onChange={onPasswordChanged}\r\n                />\r\n\r\n                <label className='title' htmlFor=\"roles\">\r\n                    НАЗНАЧЕННЫЕ РОЛИ:</label>\r\n                <select\r\n                    id=\"roles\"\r\n                    name=\"roles\"\r\n                    className={`inputsave ${validRolesClass}`}\r\n                    multiple={true}\r\n                    size=\"3\"\r\n                    value={roles}\r\n                    onChange={onRolesChanged}\r\n                >\r\n                    {options}\r\n                </select>\r\n\r\n            </form>\r\n            </div>\r\n        </div>\r\n  )\r\n}\r\n\r\nexport default NewUserForm"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}