{"ast":null,"code":"import{apiSlice}from\"../../app/api/apiSlice\";import{logOut,setCredentials}from\"./authSlice\";export const authApiSlice=apiSlice.injectEndpoints({endpoints:builder=>({login:builder.mutation({query:credentials=>({url:'/auth',method:'POST',body:{...credentials}})}),sendLogout:builder.mutation({query:()=>({url:'/auth/logout',method:'POST'}),async onQueryStarted(arg,_ref){let{dispatch,queryFulfilled}=_ref;try{const{data}=await queryFulfilled;console.log(data);dispatch(logOut());setTimeout(()=>{dispatch(apiSlice.util.resetApiState());},1000);}catch(err){console.log(err);}}}),refresh:builder.mutation({query:()=>({url:'/auth/refresh',method:'GET'}),async onQueryStarted(arg,_ref2){let{dispatch,queryFulfilled}=_ref2;try{const{data}=await queryFulfilled;console.log(data);const{accessToken}=data;dispatch(setCredentials({accessToken}));}catch(err){console.log(err);}}})})});export const{useLoginMutation,useSendLogoutMutation,useRefreshMutation}=authApiSlice;","map":{"version":3,"names":["apiSlice","logOut","setCredentials","authApiSlice","injectEndpoints","endpoints","builder","login","mutation","query","credentials","url","method","body","sendLogout","onQueryStarted","arg","_ref","dispatch","queryFulfilled","data","console","log","setTimeout","util","resetApiState","err","refresh","_ref2","accessToken","useLoginMutation","useSendLogoutMutation","useRefreshMutation"],"sources":["C:/Users/MSI/Desktop/final-map-app/client/client/src/features/auth/authApiSlice.js"],"sourcesContent":["import { apiSlice } from \"../../app/api/apiSlice\"\r\nimport { logOut, setCredentials } from \"./authSlice\"\r\n\r\nexport const authApiSlice = apiSlice.injectEndpoints({\r\n    endpoints: builder => ({\r\n        login: builder.mutation({\r\n            query: credentials => ({\r\n                url: '/auth',\r\n                method: 'POST',\r\n                body: { ...credentials }\r\n            })\r\n        }),\r\n        sendLogout: builder.mutation({\r\n            query: () => ({\r\n                url: '/auth/logout',\r\n                method: 'POST',\r\n            }),\r\n            async onQueryStarted(arg, { dispatch, queryFulfilled }) {\r\n                try {\r\n                    const { data } = await queryFulfilled\r\n                    console.log(data)\r\n                    dispatch(logOut())\r\n                    setTimeout(() => {\r\n                        dispatch(apiSlice.util.resetApiState())\r\n                    }, 1000)\r\n                } catch (err) {\r\n                    console.log(err)\r\n                }\r\n            }\r\n        }),\r\n        refresh: builder.mutation({\r\n            query: () => ({\r\n                url: '/auth/refresh',\r\n                method: 'GET',\r\n            }),\r\n            async onQueryStarted(arg, { dispatch, queryFulfilled }) {\r\n                try {\r\n                    const { data } = await queryFulfilled\r\n                    console.log(data)\r\n                    const { accessToken } = data\r\n                    dispatch(setCredentials({ accessToken }))\r\n                } catch (err) {\r\n                    console.log(err)\r\n                }\r\n            }\r\n        }),\r\n    })\r\n})\r\n\r\nexport const {\r\n    useLoginMutation,\r\n    useSendLogoutMutation,\r\n    useRefreshMutation,\r\n} = authApiSlice "],"mappings":"AAAA,OAASA,QAAQ,KAAQ,wBAAwB,CACjD,OAASC,MAAM,CAAEC,cAAc,KAAQ,aAAa,CAEpD,MAAO,MAAM,CAAAC,YAAY,CAAGH,QAAQ,CAACI,eAAe,CAAC,CACjDC,SAAS,CAAEC,OAAO,GAAK,CACnBC,KAAK,CAAED,OAAO,CAACE,QAAQ,CAAC,CACpBC,KAAK,CAAEC,WAAW,GAAK,CACnBC,GAAG,CAAE,OAAO,CACZC,MAAM,CAAE,MAAM,CACdC,IAAI,CAAE,CAAE,GAAGH,WAAY,CAC3B,CAAC,CACL,CAAC,CAAC,CACFI,UAAU,CAAER,OAAO,CAACE,QAAQ,CAAC,CACzBC,KAAK,CAAEA,CAAA,IAAO,CACVE,GAAG,CAAE,cAAc,CACnBC,MAAM,CAAE,MACZ,CAAC,CAAC,CACF,KAAM,CAAAG,cAAcA,CAACC,GAAG,CAAAC,IAAA,CAAgC,IAA9B,CAAEC,QAAQ,CAAEC,cAAe,CAAC,CAAAF,IAAA,CAClD,GAAI,CACA,KAAM,CAAEG,IAAK,CAAC,CAAG,KAAM,CAAAD,cAAc,CACrCE,OAAO,CAACC,GAAG,CAACF,IAAI,CAAC,CACjBF,QAAQ,CAACjB,MAAM,CAAC,CAAC,CAAC,CAClBsB,UAAU,CAAC,IAAM,CACbL,QAAQ,CAAClB,QAAQ,CAACwB,IAAI,CAACC,aAAa,CAAC,CAAC,CAAC,CAC3C,CAAC,CAAE,IAAI,CAAC,CACZ,CAAE,MAAOC,GAAG,CAAE,CACVL,OAAO,CAACC,GAAG,CAACI,GAAG,CAAC,CACpB,CACJ,CACJ,CAAC,CAAC,CACFC,OAAO,CAAErB,OAAO,CAACE,QAAQ,CAAC,CACtBC,KAAK,CAAEA,CAAA,IAAO,CACVE,GAAG,CAAE,eAAe,CACpBC,MAAM,CAAE,KACZ,CAAC,CAAC,CACF,KAAM,CAAAG,cAAcA,CAACC,GAAG,CAAAY,KAAA,CAAgC,IAA9B,CAAEV,QAAQ,CAAEC,cAAe,CAAC,CAAAS,KAAA,CAClD,GAAI,CACA,KAAM,CAAER,IAAK,CAAC,CAAG,KAAM,CAAAD,cAAc,CACrCE,OAAO,CAACC,GAAG,CAACF,IAAI,CAAC,CACjB,KAAM,CAAES,WAAY,CAAC,CAAGT,IAAI,CAC5BF,QAAQ,CAAChB,cAAc,CAAC,CAAE2B,WAAY,CAAC,CAAC,CAAC,CAC7C,CAAE,MAAOH,GAAG,CAAE,CACVL,OAAO,CAACC,GAAG,CAACI,GAAG,CAAC,CACpB,CACJ,CACJ,CAAC,CACL,CAAC,CACL,CAAC,CAAC,CAEF,MAAO,MAAM,CACTI,gBAAgB,CAChBC,qBAAqB,CACrBC,kBACJ,CAAC,CAAG7B,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}